{#
/**
 * @file
 * Default theme implementation for Decoupled Drupal Chatbot block.
 *
 * Available variables:
 * - button_text: The text displayed on the trigger button.
 * - button_position: Position of the button (bottom-right, bottom-left, etc).
 * - button_color: Background color for the button.
 * - show_on_mobile: Whether to show on mobile devices.
 * - trigger_delay: Auto-trigger delay in seconds.
 * - welcome_message: Welcome message for the chatbot.
 */
#}
{# Backdrop for overlay effect #}
<div id="dc-chatbot-backdrop" class="dc-chatbot-backdrop" aria-hidden="true"></div>

<div id="dc-chatbot-container"
     class="dc-chatbot-container {{ button_position }}{% if not show_on_mobile %} hide-mobile{% endif %}"
     data-position="{{ button_position }}"
     data-color="{{ button_color }}"
     data-trigger-delay="{{ trigger_delay }}"
     data-welcome="{{ welcome_message }}">

  {# Chatbot trigger button #}
  <button id="dc-chatbot-trigger"
          class="dc-chatbot-trigger"
          style="background-color: {{ button_color }}"
          type="button"
          aria-label="{{ 'Open chatbot'|t }}"
          title="{{ button_text }}">
    <span class="dc-chatbot-icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-circle-more-icon lucide-message-circle-more">
        <path d="M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719"/>
        <path d="M8 12h.01"/>
        <path d="M12 12h.01"/>
        <path d="M16 12h.01"/>
      </svg>
    </span>
    <span class="dc-chatbot-text">{{ button_text }}</span>
  </button>

  {# Off-canvas chatbot panel #}
  <div id="dc-chatbot-panel" class="dc-chatbot-panel" aria-hidden="true">
    <div class="dc-chatbot-header">
      <h3 class="dc-chatbot-title">{{ 'Decoupled Drupal Chat'|t }}</h3>
      <button id="dc-chatbot-close"
              class="dc-chatbot-close"
              type="button"
              aria-label="{{ 'Close chatbot'|t }}"
              title="{{ 'Close chatbot'|t }}">
        <span aria-hidden="true">Ã—</span>
      </button>
    </div>

    <div id="dc-chatbot-messages" class="dc-chatbot-messages">
      <div id="dc-chatbot-welcome" class="dc-chatbot-welcome">
        <div class="dc-chatbot-message bot-message">
          <div class="message-content">{{ welcome_message }}</div>
          <div class="message-time"></div>
        </div>
      </div>

      <div id="dc-chatbot-initial-options" class="dc-chatbot-initial-options">
        <div class="chatbot-action-buttons">
          <button type="button" class="chatbot-action-btn" data-action="model-content">
            Model Content
          </button>
          <button type="button" class="chatbot-action-btn" data-action="answer-question">
            Answer a Question
          </button>
        </div>
      </div>
    </div>

    <div class="dc-chatbot-input-container">
      <form id="dc-chatbot-form" class="dc-chatbot-form">
        <div class="input-wrapper">
          <input type="text"
                 id="dc-chatbot-input"
                 class="dc-chatbot-input"
                 placeholder="{{ 'Type your message...'|t }}"
                 aria-label="{{ 'Type your message'|t }}"
                 autocomplete="off"
                 required>
          <button type="submit"
                  class="dc-chatbot-send"
                  aria-label="{{ 'Send message'|t }}"
                  title="{{ 'Send message'|t }}">
            <span class="send-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-send-horizontal-icon lucide-send-horizontal">
                <path d="M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z"/>
                <path d="M6 12h16"/>
              </svg>
            </span>
          </button>
        </div>
      </form>
    </div>
  </div>

  {# Loading indicator #}
  <div id="dc-chatbot-loading" class="dc-chatbot-loading" aria-hidden="true">
    <div class="dc-chatbot-message bot-message">
      <div class="message-content">
        <div class="loading-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>
  </div>
</div>
